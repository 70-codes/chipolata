(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(t,e,r){"use strict";r.r(e);var n=r(2),s=r(3);const i=()=>{if(!window.AudioContext&&!window.webkitAudioContext)return null;const t=new(window.AudioContext||window.webkitAudioContext);return{oscillator:null,start(){this.oscillator||(this.oscillator=(t=>{const e=t.createOscillator();return e.type="sine",e.frequency.value=400,e.connect(t.destination),e})(t),this.oscillator.start())},stop(){this.oscillator&&(this.oscillator.stop(),this.oscillator=null)}}},u=(t,e)=>"0x"+t.toString(16).padStart(e,"0"),a=t=>u(4095&t,4),o=t=>(3840&t)>>8,c=t=>(240&t)>>4,l=t=>u(255&t,2),d=t=>15&t,h=(t,e)=>{const r=t[e]<<8|t[e+1];let n="-";switch(61440&r){case 0:224==r?n="CLS":238==r&&(n="RET");break;case 4096:n="JP "+a(r);break;case 8192:n="CALL "+a(r);break;case 12288:n=`SE V${o(r)}, ${l(r)}`;break;case 16384:n=`SNE V${o(r)}, ${l(r)}`;break;case 20480:n=`SE V${o(r)}, V${c(r)}`;break;case 24576:n=`LD V${o(r)}, ${l(r)}`;break;case 28672:n=`ADD V${o(r)}, ${l(r)}`;break;case 32768:switch(d(r)){case 0:n=`LD V${o(r)}, V${c(r)}`;break;case 1:n=`OR V${o(r)}, V${c(r)}`;break;case 2:n=`AND V${o(r)}, V${c(r)}`;break;case 3:n=`XOR V${o(r)}, V${c(r)}`;break;case 4:n=`ADD V${o(r)}, V${c(r)}`;break;case 5:n=`SUB V${o(r)}, V${c(r)}`;break;case 6:n=`SHR V${o(r)} {, V${c(r)}}`;break;case 7:n=`SUBN V${o(r)}, V${c(r)}`;break;case 14:n=`SHL V${o(r)} {, V${c(r)}}`}break;case 36864:n=`SNE V${o(r)}, V${c(r)}`;break;case 40960:n="LD I, "+a(r);break;case 45056:n="JP V0, "+a(r);break;case 49152:n=`RND V${o(r)}, ${l(r)}`;break;case 53248:n=`DRW V${o(r)}, ${l(r)}, ${u(d(r),1)}`;break;case 57344:158==l(r)?n="SKP V"+o(r):161==l(r)&&(n="SKNP V"+o(r));break;case 61440:switch(255&r){case 7:n=`LD V${o(r)}, DT`;break;case 10:n=`LD V${o(r)}, K`;break;case 21:n="LD DT, V"+o(r);break;case 24:n="LD ST, V"+o(r);break;case 30:n="ADD I, V"+o(r);break;case 41:n="LD F, V"+o(r);break;case 51:n="LD B, V"+o(r);break;case 85:n="LD [I], V"+o(r);break;case 101:n=`LD V${o(r)}, [I]`}}return[n]};var p={WIDTH:64,HEIGHT:32,speed:9,paused:!1,muted:!0,keysPressed:{},display:null,audio:null,$pauseBtn:null,$muteBtn:null,$resetBtn:null,$registers1:null,$registers2:null,$registers3:null,interpreter:null,v_registers:null,init(t,e){this.display=((t,e,r,n,s)=>{t.width=e,t.height=r;const i=Math.min(n-40,10*e);t.style.width=i+"px",t.style.height=i/2+"px";const u=t.getContext("2d");return{draw(t){const n=u.createImageData(e,r);for(let e=0;e<t.length;e++)n.data[4*e]=1===t[e]?255:0,n.data[4*e+1]=1===t[e]?255:0,n.data[4*e+2]=1===t[e]?255:0,n.data[4*e+3]=255;u.putImageData(n,0,0)}}})(t.getElementById("display-canvas"),this.WIDTH,this.HEIGHT,e.width,e.height),this.audio=i(),this.$pauseBtn=t.querySelector("#btn-pause"),this.$muteBtn=t.querySelector("#btn-mute"),this.$resetBtn=t.querySelector("#btn-reset"),this.$registers1=t.querySelector(".registers .values-1"),this.$registers2=t.querySelector(".registers .values-2"),this.$registers3=t.querySelector(".registers .values-3"),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onPauseClick=this.onPauseClick.bind(this),this.onMuteClick=this.onMuteClick.bind(this),this.onResetClick=this.onResetClick.bind(this),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp),this.$pauseBtn.addEventListener("click",this.onPauseClick),this.$muteBtn.addEventListener("click",this.onMuteClick),this.$resetBtn.addEventListener("click",this.onResetClick)},onKeyDown(t){this.keysPressed[t.key]=!0},onKeyUp(t){this.keysPressed[t.key]=!1},onPauseClick(){this.$pauseBtn.classList.toggle("btn-ghost"),this.$pauseBtn.textContent=this.paused?"stop":"start",this.paused=!this.paused},onMuteClick(){this.$muteBtn.classList.toggle("btn-ghost"),this.$muteBtn.textContent=this.muted?"mute":"unmute",this.muted=!this.muted},onResetClick(){this.interpreter.reset()},updateInfo(){const t=this.interpreter.get_pc(),e=this.interpreter.get_i(),r=this.interpreter.get_sp(),n=document.querySelector(".current-addr");n&&n.classList.toggle("current-addr");const s=document.querySelector(".addr-"+t);s&&(s.classList.toggle("current-addr"),s.parentElement.scrollTo(0,s.offsetTop-s.parentElement.offsetTop-70));const i=["&nbsp;DT="+u(this.interpreter.get_dt(),2)],a=["&nbsp;ST="+u(this.interpreter.get_st(),2)];for(let t=0;t<8;t++)i.push(`v${String(t).padStart(2,"0")}=${u(this.v_registers[t],2)}`),a.push(`v${String(t+8).padStart(2,"0")}=${u(this.v_registers[t+8],2)}`);this.$registers1.innerHTML=["PC="+u(t,4),"I="+u(e,4),"SP="+u(r,2)].join(" "),this.$registers2.innerHTML=i.join("<br>"),this.$registers3.innerHTML=a.join("<br>")},run(t){this.interpreter=new n.a(t),this.v_registers=new Uint8Array(s.s.buffer,this.interpreter.get_v_ptr(),16);const e=new Uint8Array(s.s.buffer,this.interpreter.get_vram_ptr(),this.WIDTH*this.HEIGHT),r=new Uint8Array(s.s.buffer,this.interpreter.get_ram_ptr(),4096);document.querySelector(".opcode .values").innerHTML=(t=>{const e=[];for(let r=513;r<4096;r+=2){const[n]=h(t,r);e.push(`<div class="addr-${r}">${u(r,4)}: ${n}</div>`)}return e.join("")})(r);const i=()=>{if(!this.paused){let r=!1;for(let e=0;e<this.speed;e++)this.interpreter.update_keypad([!!(t=this.keysPressed).x,!!t[1],!!t[2],!!t[3],!!t.q,!!t.w,!!t.e,!!t.a,!!t.s,!!t.d,!!t.z,!!t.c,!!t[4],!!t.r,!!t.f,!!t.v]),this.interpreter.step(),this.interpreter.should_redraw()&&(r=!0);r&&this.display.draw(e),this.muted||(this.interpreter.should_beep()?this.audio.start():this.audio.stop()),this.interpreter.update_timers(),this.updateInfo()}var t;requestAnimationFrame(i)};i()}};p.init(document,screen),fetch("./space-invaders.ch8").then(async t=>{const e=await t.arrayBuffer(),r=new Uint8Array(e);p.run(r)})},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return $})),r.d(e,"d",(function(){return g})),r.d(e,"q",(function(){return k})),r.d(e,"i",(function(){return y})),r.d(e,"k",(function(){return w})),r.d(e,"m",(function(){return V})),r.d(e,"j",(function(){return m})),r.d(e,"c",(function(){return _})),r.d(e,"f",(function(){return v})),r.d(e,"o",(function(){return D})),r.d(e,"b",(function(){return S})),r.d(e,"e",(function(){return L})),r.d(e,"g",(function(){return C})),r.d(e,"l",(function(){return T})),r.d(e,"h",(function(){return B})),r.d(e,"n",(function(){return P})),r.d(e,"r",(function(){return A})),r.d(e,"p",(function(){return x}));var n=r(3);const s=new Array(32).fill(void 0);function i(t){return s[t]}s.push(void 0,null,!0,!1);let u=s.length;function a(t){const e=i(t);return function(t){t<36||(s[t]=u,u=t)}(t),e}let o=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let c=null;function l(){return null!==c&&c.buffer===n.s.buffer||(c=new Uint8Array(n.s.buffer)),c}function d(t,e){return o.decode(l().subarray(t,t+e))}function h(t){u===s.length&&s.push(s.length+1);const e=u;return u=s[e],s[e]=t,e}let p=0;function f(t,e){const r=e(1*t.length);return l().set(t,r/1),p=t.length,r}function b(t){return function(){try{return t.apply(this,arguments)}catch(t){n.b(h(t))}}}class ${static __wrap(t){const e=Object.create($.prototype);return e.ptr=t,e}free(){const t=this.ptr;this.ptr=0,n.a(t)}constructor(t){var e=f(t,n.c),r=p,s=n.l(e,r);return $.__wrap(s)}update_keypad(t){var e=f(t,n.c),r=p;n.q(this.ptr,e,r)}step(){n.p(this.ptr)}should_redraw(){return 0!==n.o(this.ptr)}should_beep(){return 0!==n.n(this.ptr)}update_timers(){n.r(this.ptr)}get_vram_ptr(){return n.k(this.ptr)}get_ram_ptr(){return n.g(this.ptr)}get_pc(){return n.f(this.ptr)}get_v_ptr(){return n.j(this.ptr)}get_i(){return n.e(this.ptr)}get_sp(){return n.h(this.ptr)}get_dt(){return n.d(this.ptr)}get_st(){return n.i(this.ptr)}reset(){n.m(this.ptr)}}const g=b((function(t,e){i(t).getRandomValues(i(e))})),k=function(t){a(t)},y=b((function(t,e,r){var n,s;i(t).randomFillSync((n=e,s=r,l().subarray(n/1,n/1+s)))})),w=b((function(){return h(self.self)})),V=function(){return h(t)},m=b((function(t,e,r){return h(i(t).require(d(e,r)))})),_=function(t){return h(i(t).crypto)},v=function(t){return h(i(t).msCrypto)},D=function(t){return void 0===i(t)},S=function(t){return h(i(t).buffer)},L=function(t){return i(t).length},C=function(t){return h(new Uint8Array(i(t)))},T=function(t,e,r){i(t).set(i(e),r>>>0)},B=function(t){return h(new Uint8Array(t>>>0))},P=function(t,e,r){return h(i(t).subarray(e>>>0,r>>>0))},A=function(t,e){throw new Error(d(t,e))},x=function(){return h(n.s)}}).call(this,r(4)(t))},function(t,e,r){"use strict";var n=r.w[t.i];t.exports=n;r(2);n.t()},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}}]]);